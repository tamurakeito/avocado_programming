第3章でWidgetについて学び、いよいよ自分の手でアプリを動かしてみたい気持ちが高まってきた頃ではないでしょうか。
そのために、この第4章では **「開発環境（かいはつかんきょう）」** という、Flutterアプリを作るための作業場を皆さんのパソコンに準備します。

正直なところ、この環境構築のステップは、プログラミング学習を始めたばかりの多くの方が **最初の大きな関門（かんもん）** と感じる部分かもしれません。
なぜなら、アプリのアイデアを形にするという本来の目的とは少し離れた、パソコン自体の細かな設定作業が中心ですし、時には見たことのない英語のエラーメッセージがたくさん出てきて、「一体どうすれば…」と途方に暮れてしまうこともあるからです。

でも、もしそうなっても、**決して皆さんだけではありません**。多くの先輩開発者たちも、同じような道を通ってきました。
料理に例えるなら、これは最高の料理を作るための「キッチンの整備」や「調理器具の準備」のようなものです。
最初は少し手間がかかりますが、一度最高のキッチンが整ってしまえば、あとは思う存分、創造力を活かして料理（アプリ開発）に集中することができます。

この章では、その「最高のキッチン」を一緒に、一歩ずつ丁寧に作っていきます。手順が多く感じるかもしれませんが、**ここを乗り越えれば、いよいよ本格的にアプリを作るためのスタートラインに立てます**。
焦らず、一つ一つの手順を確認しながら、そして時には深呼吸しながら、一緒に進めていきましょう！

## 必要なもの

Flutterアプリ開発を始めるために、主に以下のものが必要になります。

### 1.Flutter SDK (エスディーケー)
Flutterアプリを開発するための中心的な道具セットです。
SDKとは「Software Development Kit（ソフトウェア ディベロップメント キット）」の略で、特定のソフトウェアを作るための設計図、素材、工具などが一式入っている箱のようなものです。

### 2.IDE (アイディーイー / 統合開発環境)
プログラムのコードを書いたり、アプリを実行したりするための高機能なエディタソフトです。
この講座では、世界中で人気があり、無料で利用できる Visual Studio Code (VS Code) を主に使います。

### 3.Android開発のためのツール (Android Studioなど)
Androidアプリを作る場合、VS Codeを使っていても、Androidの仮想デバイス（エミュレータ）やAndroid用のSDKを管理するために、Android Studioの一部機能が必要になります。

### 4.iOS開発のためのツール (Xcode - Macのみ)
iPhoneやiPadのアプリを作る場合、AppleのMacコンピュータと、Xcodeという開発ツールが必須になります。WindowsやLinuxではiOSアプリの開発・実行はできません。

### 5.エミュレータ / シミュレータ または 実機
作成したアプリを動かしてテストするための環境です。
- **エミュレータ (Android) / シミュレータ (iOS)**: パソコン上で動く仮想のスマートフォンです。
- **実機**: 皆さんが実際に使っているスマートフォンです。

## 開発の相棒：ターミナル（コマンドプロンプト）入門

これからFlutterの開発環境を整えたり、プロジェクトを操作したりする際に、**「ターミナル」**（Windowsでは「コマンドプロンプト」や「PowerShell」とも呼ばれます）という画面を頻繁（ひんぱん）に使うことになります。

### そもそも「ターミナル」って何？

皆さんが普段パソコンを操作するときは、マウスでアイコンをクリックしたり、メニューを選んだりすることが多いと思います。
ターミナルは、それとは少し違ったパソコンの操作方法で、キーボードから**文字で命令（コマンドと言います）を打ち込んでコンピュータに直接指示を出す**ための画面です。

ちょっと昔ながらの操作方法に見えるかもしれませんが、開発の世界では非常に強力で、特定の作業を効率的に行うために今でも広く使われています。
Flutterの多くの操作も、このターミナルから特定のコマンドを実行することで行います。

難しそうに聞こえるかもしれませんが、心配はいりません。
この講座で使うコマンドは限られていますし、その都度、何をしているのかを説明します。
「コンピュータに直接お願いごとをするための、ちょっと特別なチャット画面」くらいのイメージで捉えてみてください。

### ターミナルの開き方

- **macOSやLinuxをお使いの場合**: 「ターミナル」という名前のアプリケーションを起動します。（通常、アプリケーションの「ユーティリティ」フォルダなどに入っています）

- **Windowsをお使いの場合**: スタートメニューから「コマンドプロンプト」または「PowerShell」を検索して起動します。PowerShellの方が後発で多機能ですが、この講座で使う範囲ではどちらでもほぼ同じように使えます。

- **VS Codeの統合ターミナル**: VS Codeをお使いの場合、メニューの「ターミナル」>「新しいターミナル」を選択することで、VS Codeの画面内にターミナルを開くことができます。
  このVS Codeに内蔵された「統合ターミナル」は、コード編集画面とコマンド操作画面を切り替える手間が省けるので非常に便利です。
  **今後、特に断りがない場合は、このVS Codeの統合ターミナルを使うことを想定して説明を進めます。**

まずは一度、ご自身の環境でターミナルを開いてみてください。黒い（または白い）背景に文字だけが表示される画面が出てくればOKです。これから少しずつ慣れていきましょう。

## Flutter SDKのインストール

Flutter SDKのインストール方法は、お使いのパソコンのOS（Windows, macOS, Linux）によって手順が少し異なります。
また、Flutterチームによって手順が更新されることもあります。

そのため、**最新かつ正確な情報は、必ずFlutterの公式サイトで確認するようにしてください。**

- **Flutter公式サイト - インストール手順**: [https://flutter.dev/docs/get-started/install](https://flutter.dev/docs/get-started/install) <br/>
（どうしても日本語の説明が必要な場合は、ウェブ検索で「Flutter インストール 日本語」などで探すと、有志による解説記事も見つかるかもしれません。ただ本講座では上記の公式のドキュメントを参考にすることを強くお勧めします！）

一般的な手順の概要は以下の通りです（詳細は公式サイトで！）：

1. **Flutter SDKをダウンロード**:<br/>

    上記公式サイトから、お使いのOS用のFlutter SDKのZIPファイルをダウンロードします。

2. **SDKを展開（解凍）**:<br/>

    ダウンロードしたZIPファイルを、パソコンの適切な場所（例: Windowsなら `C:\flutter`、macOS/Linuxならホームディレクトリ直下の `flutter` など）に展開します。

3. **PATHを通す**:<br/>

    Flutterのコマンドをパソコンのどこからでも呼び出せるように、「PATH（パス）環境変数」というものにFlutter SDK内の bin フォルダの場所を登録します。
    これもOSによって設定方法が異なりますので、公式サイトの手順に従ってください。
    「PATHを通す」とは、パソコンに「この道具はここにあるよ」と教えてあげるようなイメージです。

4. **flutter doctor を実行**:<br/>

    コマンドプロンプト（Windows）やターミナル（macOS/Linux）を開き、`flutter doctor` と入力して実行します。
    これは、Flutterの環境設定が正しくできているか、何か不足しているものはないかを診断してくれるお医者さんのようなコマンドです。
    問題点や次に何をすべきかを教えてくれます。

flutter doctor を実行して、特に大きなエラーが表示されなくなれば、Flutter SDKの基本的なインストールは完了です。

## 開発ツール(IDE)の準備

次に、Flutterのコードを書くためのエディタ、IDEを準備します。この講座ではVS Codeを推奨します。

### Visual Studio Code (VS Code) の場合

1. **VS Codeをインストール:**<br/>

    - [公式サイト](https://code.visualstudio.com/) から、お使いのOS用のインストーラーをダウンロードし、インストールします。

2. **Flutter拡張機能をインストール:**<br/>

    - VS Codeを起動し、左側のアクティビティバーにある四角いブロックのようなアイコン（拡張機能ビュー）をクリックします。
    - 検索ボックスに `Flutter` と入力し、Dartチームが提供している公式のFlutter拡張機能を見つけて「Install」ボタンを押します。（通常、Dartの拡張機能も一緒にインストールされます）
    - 拡張機能は、VS Codeに特定の言語やフレームワークのための便利な機能（コード補完、デバッグ機能など）を追加してくれるものです。

### Android Studio の場合

Android Studioは、Androidアプリ開発のための公式IDEですが、Flutter開発にも使えます。
また、VS Codeを使う場合でも、Androidのエミュレータ設定やAndroid SDKの管理のためにインストールしておくと便利です。

1. **Android Studioをインストール:**<br/>

    - [公式サイト](https://developer.android.com/studio) からダウンロードし、インストールします。インストールには少し時間がかかる場合があります。

2. **Flutterプラグインをインストール (Android StudioをIDEとして使う場合):**<br/>

    - Android Studioを起動し、プラグインのマーケットプレイスからFlutterプラグインを検索してインストールします。
    
## エミュレータ/シミュレータ または 実機接続

アプリを実行する環境を用意しましょう。

### Android エミュレータ

1. Android Studioを起動します。
2. Welcome画面、または Tools > AVD Manager (Android Virtual Device Manager) を開きます。
3. 「Create Virtual Device...」をクリックし、画面の指示に従って好きなデバイス定義（例: Pixel 6）とシステムイメージ（Androidのバージョン）を選んでエミュレータを作成します。
4. 作成後、AVD Managerからエミュレータを起動できます。

### iOS シミュレータ (macOS のみ)

1. XcodeをMac App Storeからインストールします。
2. Xcodeを一度起動して、必要な初期設定や追加コンポーネントのインストールを済ませます。
3. 通常、XcodeをインストールするとiOSシミュレータも一緒にインストールされます。ターミナルで `open -a Simulator` と入力するか、VS CodeやXcodeから起動できます。

### 実機接続 (Android / iOS)

ご自身のスマートフォンを開発に使うこともできます。<br/>
（ここでは簡単な説明に留めます！ 実機接続の詳細は、OSのバージョンや機種によって異なる場合があるので、公式ドキュメントやウェブ検索で確認してみてください。）

1. **Androidの場合:**

    1. スマートフォンで「開発者向けオプション」を有効にします。 (設定アプリの「端末情報」にある「ビルド番号」を7回程度連続タップすると有効になる機種が多いです)
    2. 「開発者向けオプション」の中から「USBデバッグ」をオンにします。
    3. USBケーブルでパソコンとスマートフォンを接続します。

2. **iOSの場合 (macOS のみ):**

    1. USBケーブルでMacとiPhone/iPadを接続します。
    2. 通常、Xcodeが認識し、開発用に設定するかの確認が出ることがあります。

## 初めてのFlutterプロジェクト作成

さあ、ターミナルの使い方も少しイメージできたところで、いよいよ最初のFlutterプロジェクトを作ってみましょう！

### 1.プロジェクトを保存したいフォルダにターミナルで移動する

VS Codeの統合ターミナル、またはOS標準のターミナルを開いている状態で、`cd`（チェンジディレクトリの略）というコマンドを使って、これから作るFlutterプロジェクトを保存したいフォルダ（ディレクトリ）に移動します。
これは、作業する場所をパソコンに教えるようなものです。
例えば、皆さんの「書類 (Documents)」フォルダの中に `flutter_projects` という名前のフォルダをあらかじめ作っておき、そこにプロジェクトをまとめていくとします。
ターミナルで以下のように入力して、そのフォルダに移動します（`YourUserName` の部分はご自身のパソコンのユーザー名に置き換えてください）。

- macOS/Linuxの場合 (VS Code統合ターミナル含む):

<SyntaxHighlighter language="bash">
{`cd ~/Documents/flutter_projects`}
</SyntaxHighlighter>

（~/ はホームディレクトリを指す省略形です）

- WindowsでPowerShellの場合 (VS Code統合ターミナル含む):

<SyntaxHighlighter language="bash">
{`cd ~\Documents\flutter_projects`}
</SyntaxHighlighter>

- Windowsでコマンドプロンプトの場合:

<SyntaxHighlighter language="bash">
{`cd C:\Users\YourUserName\Documents\flutter_projects`}
</SyntaxHighlighter>

`cd` の後には半角スペースを忘れずに入力してください。
フォルダの場所（パスと言います）は、ご自身の環境に合わせて正確に指定する必要があります。
もし指定したフォルダが存在しない場合はエラーになるので、フォルダは事前に作成しておきましょう。
（ターミナルの表示が、移動先のフォルダ名に変わっていれば成功です）

### 2.flutter create コマンドを実行

プロジェクトを保存したいフォルダに移動したら、いよいよプロジェクト作成コマンドです。
以下のコマンドを実行してください。
プロジェクト名は**小文字のアルファベットとアンダースコアのみ**（例: `my_first_app` や `todo_app`）を使用してください。
大文字やハイフンは使えません。

<SyntaxHighlighter language="bash">
{`flutter create my_first_app`}
</SyntaxHighlighter>

`my_first_app` の部分が皆さんのプロジェクト名になります。
Enterキーを押すと、Flutterが必要なファイルやフォルダの構成（プロジェクトの雛形（ひながた）と呼びます）を自動で作成してくれます。
「All done!」のようなメッセージが表示されれば成功です。

### 3.作成したプロジェクトをVS Codeで開く

プロジェクトの作成が完了したら、VS Codeでそのプロジェクトフォルダを開きましょう。

- VS Codeのメニューから「ファイル」>「フォルダを開く...」（または「Open Folder...」）を選択し、先ほど作成したプロジェクトフォルダ（例: `my_first_app`）を選びます。
- あるいは、VS Codeの統合ターミナルを使っていて、かつターミナルでプロジェクトフォルダの直下にいる場合（例: `cd my_first_app` で `my_first_app` フォルダに入った後）、 `code .` （ドットの前に半角スペース）と入力してEnterキーを押すことでも開けます（VS Codeの `code` コマンドがPATHに設定されている場合）。

VS Codeでプロジェクトが開かれると、画面左側のエクスプローラービュー（ファイルのアイコン）に、たくさんのファイルやフォルダが表示されるはずです。主なものをいくつか紹介します。

- `lib` フォルダ: 主に皆さんがDartのコードを書いていく場所です。この中の `main.dart` というファイルが、アプリが最初に起動する際に実行される中心的なファイルになります。
- `pubspec.yaml` ファイル: プロジェクト全体の設定ファイルです。アプリの名前や説明、使いたい外部の便利な部品（パッケージと言います）などを記述します。

今はこれらの詳細を全て覚える必要はありません。「こんなものがあるんだな」くらいで大丈夫です。徐々に慣れていきましょう。

## 「ハローワールド！」カウンターアプリを動かしてみよう

新しくFlutterプロジェクトを作成すると、実は最初から簡単なサンプルアプリ（ボタンを押すと数字が増えるカウンターアプリ）のコードが `lib/main.dart` に書かれています。これを動かしてみましょう！

### 1.実行デバイスの選択

VS Codeのウィンドウ右下にあるステータスバーに、現在選択されているデバイスが表示されています（例: `No Device`、`Chrome (web)`など）。
ここをクリックすると、起動しているエミュレータ/シミュレータや接続されている実機の一覧が表示されるので、アプリを実行したいデバイスを選択します。

### 2.アプリの実行（デバッグ開始）

VS Codeのメニューから「Run」>「Start Debugging」を選択するか、キーボードの F5 キーを押します。
初回起動時は、アプリのビルド（組み立て作業）に少し時間がかかります。
しばらく待つと、選択したデバイスにFlutterのサンプルアプリ（青い背景で、真ん中に数字が表示され、右下に `+` ボタンがあるアプリ）が起動するはずです！

おめでとうございます！ これで皆さんは最初のFlutterアプリを自分の手で動かすことができました！

`+` ボタンをタップして、数字が増えるのを確認してみてください。
さらに、`lib/main.dart` ファイルを開き、例えば `title: Text('Flutter Demo Home Page')` と書かれている部分を `title: Text('はじめてのアプリ')` のように書き換えて保存してみてください。
実行中のアプリのタイトルバーの文字が、ほぼ瞬時に変わるのが分かるでしょうか？ これが第1章で触れた**ホットリロード**です！

---

開発環境のセットアップ、お疲れ様でした！ 
環境構築は、特に最初はいろいろなソフトウェアのインストールや設定が絡むため、つまずきやすいポイントでもあります。
もしうまくいかない場合は、慌てずにエラーメッセージをよく読んだり、`flutter doctor` の診断結果を確認したり、公式サイトのドキュメントやQ&Aサイトを参考にしてみてください。

これで、Flutterアプリを開発し、動かすための土台が整いました。
次の章では、このカウンターアプリを題材に、いよいよRiverpodとHooksを使ったモダンな状態管理の方法を学んでいきます！